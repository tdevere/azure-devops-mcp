{
  "templateName": "Azure DevOps Pipeline Failure ICM Report Template",
  "templateVersion": "2.0.0",
  "description": "Comprehensive template for collecting pipeline failure information and generating ICM reports for Azure DevOps incidents",
  "createdDate": "2025-08-06",
  "icmIntegration": {
    "enabled": true,
    "autoGenerateTitle": true,
    "severityMapping": {
      "Critical - Complete service down": "Sev1",
      "High - Major functionality impaired": "Sev2",
      "Medium - Some functionality affected": "Sev3",
      "Low - Minor issues": "Sev4"
    },
    "requiredFields": ["organizationName", "problemDescription", "impactLevel", "businessImpact"]
  },
  "sections": {
    "customerDetails": {
      "title": "Customer Details",
      "required": true,
      "fields": {
        "organizationName": {
          "label": "AzDev Services Org Name",
          "type": "string",
          "format": "dev.azure.com/<ORG_NAME>",
          "required": true,
          "placeholder": "dev.azure.com/contoso"
        },
        "azureBillingSubGuid": {
          "label": "Azure Billing Subscription GUID",
          "type": "string",
          "format": "uuid",
          "required": false,
          "placeholder": "12345678-1234-1234-1234-123456789012",
          "defaultValue": "n/a"
        },
        "aadGuid": {
          "label": "Azure Active Directory GUID",
          "type": "string",
          "format": "uuid",
          "required": false,
          "placeholder": "87654321-4321-4321-4321-210987654321",
          "defaultValue": "n/a"
        },
        "sourceCodeProvider": {
          "label": "Source Code Provider",
          "type": "enum",
          "required": true,
          "options": [
            "Azure Repos",
            "TFVC",
            "GitHub",
            "Other"
          ],
          "otherField": {
            "enabled": true,
            "label": "Please specify other provider"
          }
        }
      }
    },
    "issueDescription": {
      "title": "Issue Description",
      "required": true,
      "fields": {
        "problemDescription": {
          "label": "Clear description of the issue",
          "type": "textarea",
          "required": true,
          "placeholder": "Describe the issue including any error messages the customer receives"
        },
        "errorMessages": {
          "label": "Error Messages",
          "type": "array",
          "items": {
            "type": "string"
          },
          "placeholder": "List any specific error messages"
        },
        "impactLevel": {
          "label": "Impact Level",
          "type": "enum",
          "required": true,
          "options": [
            "Critical - Complete service down",
            "High - Major functionality impaired",
            "Medium - Some functionality affected",
            "Low - Minor issues"
          ]
        },
        "affectedUsers": {
          "label": "Number of affected users/teams",
          "type": "number",
          "required": true
        },
        "geographicImpact": {
          "label": "Geographic impact",
          "type": "enum",
          "options": [
            "Global",
            "Regional",
            "Single datacenter",
            "Organization-specific"
          ]
        },
        "serviceComponents": {
          "label": "Affected Azure DevOps service components",
          "type": "array",
          "items": {
            "type": "enum",
            "options": [
              "Azure Pipelines",
              "Azure Repos",
              "Azure Boards",
              "Azure Test Plans",
              "Azure Artifacts",
              "Build agents",
              "Release management",
              "Service connections"
            ]
          }
        }
      }
    },
    "troubleshootingData": {
      "title": "Troubleshooting Data Collection",
      "required": true,
      "fields": {
        "requiredRuns": {
          "label": "Required Pipeline Runs",
          "type": "object",
          "properties": {
            "successfulRun": {
              "label": "A successful run of the pipeline",
              "type": "object",
              "properties": {
                "buildId": {
                  "type": "number",
                  "required": true
                },
                "buildNumber": {
                  "type": "string",
                  "required": true
                },
                "url": {
                  "type": "string",
                  "format": "url"
                }
              }
            },
            "firstFailureRun": {
              "label": "The run containing the first instance of the problem",
              "type": "object",
              "properties": {
                "buildId": {
                  "type": "number"
                },
                "buildNumber": {
                  "type": "string"
                },
                "url": {
                  "type": "string",
                  "format": "url"
                },
                "available": {
                  "type": "boolean",
                  "default": true
                }
              }
            },
            "debugEnabledRun": {
              "label": "A run demonstrating the problem with system.debug set to true",
              "type": "object",
              "required": true,
              "properties": {
                "buildId": {
                  "type": "number",
                  "required": true
                },
                "buildNumber": {
                  "type": "string",
                  "required": true
                },
                "url": {
                  "type": "string",
                  "format": "url"
                },
                "debugEnabled": {
                  "type": "boolean",
                  "default": true,
                  "required": true
                }
              }
            }
          }
        },
        "pipelineDetails": {
          "label": "Pipeline Details (for each affected pipeline)",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "projectName": {
                "type": "string",
                "required": true
              },
              "pipelineName": {
                "type": "string",
                "required": true
              },
              "runId": {
                "type": "number",
                "required": true
              },
              "buildId": {
                "type": "number"
              },
              "releaseId": {
                "type": "number"
              },
              "logsAttached": {
                "type": "boolean",
                "default": false
              },
              "logsLocation": {
                "type": "string",
                "placeholder": "Path or URL to pipeline logs"
              }
            }
          }
        },
        "failurePattern": {
          "label": "Failure Pattern Analysis",
          "type": "object",
          "properties": {
            "failureCount": {
              "label": "How many times has this failed?",
              "type": "number",
              "required": true
            },
            "failureFrequency": {
              "label": "Failure frequency",
              "type": "enum",
              "required": true,
              "options": [
                "Sporadic",
                "All runs",
                "Intermittent",
                "Time-based pattern"
              ]
            },
            "userImpact": {
              "label": "Is it happening for all users?",
              "type": "enum",
              "required": true,
              "options": [
                "All users",
                "Specific users only",
                "Random users",
                "Unknown"
              ]
            },
            "affectedUsers": {
              "label": "List of affected users (if specific)",
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "pipelineConfiguration": {
          "label": "Pipeline Configuration",
          "type": "object",
          "properties": {
            "exportedDefinition": {
              "label": "Exported pipeline definition",
              "type": "string",
              "format": "file",
              "description": "JSON or YAML export of the pipeline definition"
            },
            "agentPoolType": {
              "label": "What kind of pool is the agent machine in?",
              "type": "enum",
              "required": true,
              "options": [
                "Microsoft-hosted",
                "Self-hosted",
                "VMSS Pool",
                "Other"
              ]
            },
            "agentPoolName": {
              "label": "Agent pool name",
              "type": "string",
              "required": true
            },
            "isVmssPool": {
              "label": "Is it a VMSS Pool?",
              "type": "boolean"
            },
            "agentVersion": {
              "label": "Agent version",
              "type": "string"
            },
            "osType": {
              "label": "Operating system",
              "type": "enum",
              "options": ["Windows", "Linux", "macOS"]
            },
            "imageType": {
              "label": "Agent image type",
              "type": "string",
              "placeholder": "e.g., ubuntu-latest, windows-2022, macOS-latest"
            }
          }
        },
        "pipelineFailureAnalysis": {
          "label": "Pipeline Failure Analysis",
          "type": "object",
          "required": true,
          "properties": {
            "failureStage": {
              "label": "Stage where failure occurred",
              "type": "enum",
              "required": true,
              "options": [
                "Queue/Scheduling",
                "Agent allocation",
                "Source checkout",
                "Build/Compilation",
                "Test execution",
                "Deployment",
                "Post-build cleanup",
                "Variable resolution",
                "Service connection",
                "Artifact handling"
              ]
            },
            "failureType": {
              "label": "Type of failure",
              "type": "enum",
              "required": true,
              "options": [
                "Infrastructure failure",
                "Code/compilation error",
                "Test failure",
                "Configuration error",
                "Network/connectivity issue",
                "Permission/authentication error",
                "Resource constraint",
                "Timeout",
                "External dependency failure"
              ]
            },
            "errorCodes": {
              "label": "Specific error codes or exit codes",
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "failureSymptoms": {
              "label": "Observable failure symptoms",
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "taskFailureDetails": {
      "title": "Task Failure Analysis",
      "description": "Complete this section if the problem is related to a task failure",
      "required": false,
      "condition": "issueType === 'task_failure'",
      "fields": {
        "taskInformation": {
          "label": "Task Information",
          "type": "object",
          "properties": {
            "taskName": {
              "label": "Task Name and version",
              "type": "string",
              "required": true,
              "placeholder": "e.g., PowerShell@2, AzureCLI@1"
            },
            "taskVersion": {
              "label": "Task version",
              "type": "string",
              "required": true
            }
          }
        },
        "historicalContext": {
          "label": "Historical Context",
          "type": "object",
          "properties": {
            "whenStarted": {
              "label": "When did the issue start happening?",
              "type": "string",
              "required": true
            },
            "everWorked": {
              "label": "Was it ever working?",
              "type": "enum",
              "required": true,
              "options": [
                "Yes, was working before",
                "Never worked",
                "Unknown"
              ]
            },
            "additionalContext": {
              "label": "Additional timeline information",
              "type": "textarea"
            }
          }
        },
        "failingArtifacts": {
          "label": "Failing Artifacts",
          "type": "object",
          "properties": {
            "scripts": {
              "label": "Failing scripts (PowerShell, CMD, Bash)",
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "scriptName": {
                    "type": "string"
                  },
                  "scriptType": {
                    "type": "enum",
                    "options": ["PowerShell", "CMD", "Bash", "Python", "Other"]
                  },
                  "content": {
                    "type": "string",
                    "format": "code"
                  }
                }
              }
            },
            "armTemplates": {
              "label": "ARM Templates",
              "type": "array",
              "items": {
                "type": "string",
                "format": "json"
              }
            },
            "workerLogFiles": {
              "label": "Worker log files capturing the failure",
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "comparativeAnalysis": {
          "label": "Comparative Analysis",
          "type": "object",
          "properties": {
            "successVsFailure": {
              "label": "Comparison between successful and failure logs",
              "type": "textarea",
              "placeholder": "Document any changes related to agent version, image version, task version"
            },
            "changesIdentified": {
              "label": "Changes identified",
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "changeType": {
                    "type": "enum",
                    "options": ["Agent version", "Image version", "Task version", "Environment", "Other"]
                  },
                  "oldValue": {
                    "type": "string"
                  },
                  "newValue": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  }
                }
              }
            }
          }
        }
      }
    },
    "pipelineExecutionIssues": {
      "title": "Pipeline Execution Issues",
      "description": "Complete if problem is related to pipelines/stages/jobs/tasks running or not",
      "required": false,
      "condition": "issueType === 'execution_issue'",
      "fields": {
        "pipelineState": {
          "label": "Pipeline State",
          "type": "object",
          "properties": {
            "isPaused": {
              "label": "Is the pipeline paused?",
              "type": "boolean",
              "required": true
            },
            "pauseReason": {
              "label": "Reason for pause (if paused)",
              "type": "string"
            }
          }
        },
        "nodeAnalysis": {
          "label": "Node Analysis",
          "type": "object",
          "properties": {
            "evaluatedConditions": {
              "label": "Evaluated conditions of each node in the graph",
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "nodeName": {
                    "type": "string"
                  },
                  "nodeType": {
                    "type": "enum",
                    "options": ["Stage", "Job", "Task", "Step"]
                  },
                  "condition": {
                    "type": "string"
                  },
                  "evaluationResult": {
                    "type": "boolean"
                  },
                  "evaluationDetails": {
                    "type": "string"
                  }
                }
              }
            },
            "cancelationTimeouts": {
              "label": "Cancelation timeouts for each node in the graph",
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "nodeName": {
                    "type": "string"
                  },
                  "timeoutMinutes": {
                    "type": "number"
                  },
                  "timeoutAction": {
                    "type": "enum",
                    "options": ["Cancel", "Kill", "None"]
                  }
                }
              }
            }
          }
        }
      }
    },
    "debuggingCompleted": {
      "title": "Debugging Completed",
      "required": true,
      "fields": {
        "troubleshootingSteps": {
          "label": "Troubleshooting steps performed",
          "type": "array",
          "required": true,
          "items": {
            "type": "object",
            "properties": {
              "step": {
                "type": "string",
                "required": true
              },
              "result": {
                "type": "string"
              },
              "timestamp": {
                "type": "string",
                "format": "datetime"
              },
              "performedBy": {
                "type": "string"
              }
            }
          }
        },
        "toolsUsed": {
          "label": "Debugging tools used",
          "type": "array",
          "items": {
            "type": "enum",
            "options": [
              "Azure DevOps REST API",
              "Azure CLI",
              "PowerShell",
              "Build logs analysis",
              "Agent logs",
              "Network traces",
              "Performance monitoring",
              "Other"
            ]
          }
        },
        "dataCollected": {
          "label": "Data collected during debugging",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "dataType": {
                "type": "string"
              },
              "location": {
                "type": "string"
              },
              "description": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "escalationRequest": {
      "title": "Escalation Request",
      "required": true,
      "fields": {
        "requestType": {
          "label": "What do you need from the EEE/EG?",
          "type": "enum",
          "required": true,
          "options": [
            "Root cause analysis",
            "Code review",
            "Architecture guidance",
            "Performance analysis",
            "Bug fix",
            "Feature request",
            "Documentation",
            "Other"
          ]
        },
        "specificAsk": {
          "label": "Specific request details",
          "type": "textarea",
          "required": true,
          "placeholder": "Detailed description of what you need help with"
        },
        "urgency": {
          "label": "Urgency level",
          "type": "enum",
          "required": true,
          "options": [
            "Critical - Production down",
            "High - Major impact",
            "Medium - Moderate impact",
            "Low - Minor impact"
          ]
        },
        "businessImpact": {
          "label": "Business impact",
          "type": "textarea",
          "placeholder": "Describe the business impact of this issue"
        },
        "preferredResolution": {
          "label": "Preferred resolution timeline",
          "type": "enum",
          "options": [
            "Immediate (within 4 hours)",
            "Same day",
            "Within 2-3 days",
            "Within a week",
            "No specific timeline"
          ]
        }
      }
    },
    "icmReportGeneration": {
      "title": "ICM Report Generation",
      "description": "Information required for generating an Incident Management report",
      "required": true,
      "fields": {
        "incidentSummary": {
          "label": "Incident summary (auto-generated if empty)",
          "type": "string",
          "maxLength": 200,
          "autoGenerate": true,
          "template": "Pipeline failure in {{organizationName}}: {{failureType}} affecting {{affectedUsers}} users"
        },
        "incidentDescription": {
          "label": "Detailed incident description",
          "type": "textarea",
          "required": true,
          "autoGenerate": true,
          "template": "Pipeline failures detected in organization {{organizationName}}.\n\nFailure Details:\n- Stage: {{failureStage}}\n- Type: {{failureType}}\n- Error Messages: {{errorMessages}}\n- Impact Level: {{impactLevel}}\n- Affected Users: {{affectedUsers}}\n\nTroubleshooting performed:\n{{troubleshootingSteps}}"
        },
        "severity": {
          "label": "ICM Severity",
          "type": "enum",
          "required": true,
          "autoMap": "impactLevel",
          "options": [
            "Sev1 - Critical service down",
            "Sev2 - Major functionality impaired",
            "Sev3 - Some functionality affected",
            "Sev4 - Minor issues"
          ]
        },
        "owningTeam": {
          "label": "Owning team for incident",
          "type": "enum",
          "required": true,
          "options": [
            "Azure DevOps - Pipelines",
            "Azure DevOps - Repos",
            "Azure DevOps - Boards",
            "Azure DevOps - Test Plans",
            "Azure DevOps - Artifacts",
            "Azure DevOps - Platform",
            "Azure Infrastructure"
          ]
        },
        "rootCauseCategory": {
          "label": "Root cause category",
          "type": "enum",
          "options": [
            "Code defect",
            "Configuration error",
            "Infrastructure failure",
            "Capacity issue",
            "External dependency",
            "Security issue",
            "Process failure",
            "Human error",
            "Under investigation"
          ]
        },
        "mitigationActions": {
          "label": "Immediate mitigation actions taken",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "action": {
                "type": "string",
                "required": true
              },
              "timestamp": {
                "type": "string",
                "format": "datetime"
              },
              "performedBy": {
                "type": "string"
              },
              "effectiveness": {
                "type": "enum",
                "options": ["Effective", "Partial", "Not effective", "Unknown"]
              }
            }
          }
        },
        "communicationPlan": {
          "label": "Communication and notification plan",
          "type": "object",
          "properties": {
            "customerNotification": {
              "label": "Customer notification required",
              "type": "boolean",
              "default": false
            },
            "internalNotification": {
              "label": "Internal team notification",
              "type": "boolean",
              "default": true
            },
            "escalationRequired": {
              "label": "Escalation to leadership required",
              "type": "boolean"
            },
            "publicStatusPage": {
              "label": "Update public status page",
              "type": "boolean"
            }
          }
        }
      }
    },
    "resolutionTracking": {
      "title": "Resolution Tracking",
      "description": "Track resolution progress and follow-up actions",
      "required": false,
      "fields": {
        "resolutionStatus": {
          "label": "Current resolution status",
          "type": "enum",
          "options": [
            "Investigating",
            "Root cause identified",
            "Fix in progress",
            "Fix deployed",
            "Monitoring",
            "Resolved",
            "Closed"
          ]
        },
        "estimatedResolution": {
          "label": "Estimated time to resolution",
          "type": "string"
        },
        "followUpActions": {
          "label": "Required follow-up actions",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "action": {
                "type": "string",
                "required": true
              },
              "owner": {
                "type": "string"
              },
              "dueDate": {
                "type": "string",
                "format": "date"
              },
              "priority": {
                "type": "enum",
                "options": ["High", "Medium", "Low"]
              }
            }
          }
        },
        "lessonsLearned": {
          "label": "Lessons learned and process improvements",
          "type": "textarea"
        }
      }
    }
  },
  "metadata": {
    "schemaVersion": "1.0",
    "lastUpdated": "2025-08-06",
    "compatibleWith": [
      "Azure DevOps Server 2022",
      "Azure DevOps Services"
    ],
    "tags": [
      "troubleshooting",
      "pipeline",
      "debugging",
      "escalation"
    ]
  },
  "integrations": {
    "azureDevOpsMcp": {
      "enabled": true,
      "autoFillFields": [
        "organizationName",
        "projectName",
        "pipelineName",
        "buildId",
        "agentPoolType",
        "agentPoolName",
        "agentVersion",
        "failureStage",
        "errorCodes"
      ],
      "suggestedTools": [
        "mcp_ado_build_get_failed_builds",
        "mcp_ado_build_generate_failure_report",
        "mcp_ado_build_get_failed_builds_detailed",
        "mcp_ado_build_get_failed_builds_by_definition"
      ]
    },
    "icmIntegration": {
      "enabled": true,
      "autoCreateIncident": false,
      "templateMapping": {
        "title": "incidentSummary",
        "description": "incidentDescription",
        "severity": "severity",
        "owningTeam": "owningTeam",
        "rootCause": "rootCauseCategory"
      },
      "requiredForCreation": [
        "incidentSummary",
        "incidentDescription",
        "severity",
        "owningTeam"
      ]
    },
    "notificationChannels": {
      "teams": {
        "enabled": true,
        "channels": [
          "azure-devops-alerts",
          "pipeline-failures",
          "incident-management"
        ]
      },
      "email": {
        "enabled": true,
        "distributionLists": [
          "azdevops-oncall@microsoft.com",
          "pipeline-support@microsoft.com"
        ]
      }
    }
  },
  "automationRules": {
    "autoSeverityMapping": {
      "enabled": true,
      "rules": [
        {
          "condition": "affectedUsers > 1000",
          "setSeverity": "Sev1 - Critical service down"
        },
        {
          "condition": "affectedUsers > 100 && failureType === 'Infrastructure failure'",
          "setSeverity": "Sev2 - Major functionality impaired"
        },
        {
          "condition": "geographicImpact === 'Global'",
          "setSeverity": "Sev1 - Critical service down"
        }
      ]
    },
    "autoEscalation": {
      "enabled": true,
      "rules": [
        {
          "condition": "severity === 'Sev1' && resolutionStatus !== 'Resolved'",
          "escalateAfter": "1 hour",
          "escalateTo": "leadership"
        },
        {
          "condition": "severity === 'Sev2' && resolutionStatus !== 'Resolved'",
          "escalateAfter": "4 hours",
          "escalateTo": "senior-engineers"
        }
      ]
    }
  }
}
